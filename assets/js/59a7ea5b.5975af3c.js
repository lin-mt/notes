"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[8862],{8640:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>h,contentTitle:()=>t,default:()=>o,frontMatter:()=>c,metadata:()=>l,toc:()=>d});var a=n(4848),s=n(8453);const c={},t="Rancher",l={id:"dev-ops/k8s/deploy-component/rancher",title:"Rancher",description:"\u4ecb\u7ecd",source:"@site/docs/dev-ops/k8s/deploy-component/rancher.md",sourceDirName:"dev-ops/k8s/deploy-component",slug:"/dev-ops/k8s/deploy-component/rancher",permalink:"/notes/docs/dev-ops/k8s/deploy-component/rancher",draft:!1,unlisted:!1,editUrl:"https://github.com/lin-mt/notes/tree/main/docs/dev-ops/k8s/deploy-component/rancher.md",tags:[],version:"current",frontMatter:{},sidebar:"devOpsK8S",previous:{title:"Debian 12 \u4f7f\u7528 RKE2 \u79bb\u7ebf\u90e8\u7f72 k8s",permalink:"/notes/docs/dev-ops/k8s/deploy/debian-rke2"}},h={},d=[{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:2},{value:"\u51c6\u5907",id:"\u51c6\u5907",level:2},{value:"\u90e8\u7f72 Rancher",id:"\u90e8\u7f72-rancher",level:2},{value:"\u4e0b\u8f7d Rancher",id:"\u4e0b\u8f7d-rancher",level:3},{value:"\u90e8\u7f72<code>cert-manager</code>",id:"\u90e8\u7f72cert-manager",level:3},{value:"\u5b89\u88c5 Rancher",id:"\u5b89\u88c5-rancher",level:3},{value:"\u5347\u7ea7 Rancher",id:"\u5347\u7ea7-rancher",level:2},{value:"\u91cd\u7f6e\u7ba1\u7406\u5458\u5bc6\u7801",id:"\u91cd\u7f6e\u7ba1\u7406\u5458\u5bc6\u7801",level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}];function i(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.h1,{id:"rancher",children:"Rancher"}),"\n",(0,a.jsx)(r.h2,{id:"\u4ecb\u7ecd",children:"\u4ecb\u7ecd"}),"\n",(0,a.jsx)(r.p,{children:"Rancher \u662f\u4e00\u4e2a Kubernetes \u7ba1\u7406\u5de5\u5177\uff0c\u8ba9\u6211\u4eec\u80fd\u5728\u4efb\u4f55\u5730\u65b9\u548c\u4efb\u4f55\u63d0\u4f9b\u5546\u4e0a\u90e8\u7f72\u548c\u8fd0\u884c\u96c6\u7fa4\u3002"}),"\n",(0,a.jsx)(r.h2,{id:"\u51c6\u5907",children:"\u51c6\u5907"}),"\n",(0,a.jsxs)(r.p,{children:["\u4e00\u4e2a\u5b89\u88c5\u4e86 Helm \u7684 Kubernetes \u96c6\u7fa4\uff0c\u96c6\u7fa4\u7248\u672c\u8981\u8ddf\u5b89\u88c5\u7684 Rancher \u7248\u672c\u517c\u5bb9\uff0c\u5177\u4f53\u53ef\u4ee5\u67e5\u8be2\uff1a",(0,a.jsx)(r.a,{href:"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions",children:"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions"})," \u6216\u8005\u67e5\u770b",(0,a.jsx)(r.a,{href:"https://github.com/rancher/rancher/releases",children:"Github Release"}),"\u3002"]}),"\n",(0,a.jsx)(r.h2,{id:"\u90e8\u7f72-rancher",children:"\u90e8\u7f72 Rancher"}),"\n",(0,a.jsx)(r.h3,{id:"\u4e0b\u8f7d-rancher",children:"\u4e0b\u8f7d Rancher"}),"\n",(0,a.jsx)(r.p,{children:"\u6dfb\u52a0 Rancher \u4ed3\u5e93"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"helm repo add rancher-stable https://releases.rancher.com/server-charts/stable\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u4e0b\u8f7d\u6700\u65b0\u7a33\u5b9a\u7248 Rancher"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"mkdir ~/rancher && cd ~/rancher && helm fetch rancher-stable/rancher\n"})}),"\n",(0,a.jsxs)(r.h3,{id:"\u90e8\u7f72cert-manager",children:["\u90e8\u7f72",(0,a.jsx)(r.code,{children:"cert-manager"})]}),"\n",(0,a.jsx)(r.p,{children:"\u6dfb\u52a0 cert-manager \u4ed3\u5e93"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"helm repo add jetstack https://charts.jetstack.io && helm repo update\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u4e0b\u8f7d cert-manager"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",metastring:"{2}",children:"mkdir ~/cert-manager && cd ~/cert-manager\nhelm fetch jetstack/cert-manager --version v1.13.3\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u90e8\u7f72 cert-manager"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",metastring:"{1,5}",children:"curl -L -o cert-manager.crds.yaml https://github.com/cert-manager/cert-manager/releases/download/v1.13.3/cert-manager.crds.yaml\nkubectl create namespace cert-manager\nkubectl apply -f cert-manager.crds.yaml\nhelm install cert-manager ./cert-manager-v1.13.3.tgz \\\n  --namespace cert-manager \\\n  --set image.repository=quay.io/jetstack/cert-manager-controller \\\n  --set webhook.image.repository=quay.io/jetstack/cert-manager-webhook \\\n  --set cainjector.image.repository=quay.io/jetstack/cert-manager-cainjector \\\n  --set startupapicheck.image.repository=quay.io/jetstack/cert-manager-ctl\n"})}),"\n",(0,a.jsx)(r.h3,{id:"\u5b89\u88c5-rancher",children:"\u5b89\u88c5 Rancher"}),"\n",(0,a.jsx)(r.p,{children:"\u521b\u5efa\u547d\u540d\u7a7a\u95f4"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"kubectl create namespace cattle-system\n"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",metastring:"{1,3,4}",children:"helm install rancher ./rancher-2.7.9.tgz \\\n  --namespace cattle-system \\\n  --set hostname=rancher.linmt.cn \\\n  --set cert-manager.version=v1.13.3 \\\n  --set rancherImage=docker.io/rancher/rancher \\\n  --set systemDefaultRegistry=registry.cn-hangzhou.aliyuncs.com \\\n  --set useBundledSystemChart=true\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u67e5\u770b\u5b89\u88c5\u7ed3\u679c"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"kubectl -n cattle-system get pod\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u83b7\u53d6\u9ed8\u8ba4\u7ba1\u7406\u5458\u8d26\u53f7\uff08admin\uff09\u5bc6\u7801"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"kubectl get secret --namespace cattle-system bootstrap-secret -o go-template='{{ .data.bootstrapPassword|base64decode}}{{ \"\\n\" }}'\n"})}),"\n",(0,a.jsx)(r.h2,{id:"\u5347\u7ea7-rancher",children:"\u5347\u7ea7 Rancher"}),"\n",(0,a.jsx)(r.p,{children:"\u5bfc\u51fa\u5b89\u88c5\u65f6\u7684\u81ea\u5b9a\u4e49\u4fe1\u606f\uff1a"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"helm get values rancher -n cattle-system -o yaml > values.yaml\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u5347\u7ea7 Rancher"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"helm upgrade rancher rancher-<CHART_REPO>/rancher \\\n  --namespace cattle-system \\\n  -f values.yaml \\\n  --version=2.6.8\n"})}),"\n",(0,a.jsx)(r.h2,{id:"\u91cd\u7f6e\u7ba1\u7406\u5458\u5bc6\u7801",children:"\u91cd\u7f6e\u7ba1\u7406\u5458\u5bc6\u7801"}),"\n",(0,a.jsx)(r.p,{children:"Docker \u91cd\u7f6e\u7ba1\u7406\u5458\u5bc6\u7801"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"$ docker exec -ti <container_id> reset-password\nNew password for default administrator (user-xxxxx):\n<new_password>\n"})}),"\n",(0,a.jsx)(r.p,{children:"Kubernetes \u5b89\u88c5 (Helm):"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"$ KUBECONFIG=./kube_config_cluster.yml\n$ kubectl --kubeconfig $KUBECONFIG -n cattle-system exec $(kubectl --kubeconfig $KUBECONFIG -n cattle-system get pods -l app=rancher --no-headers | head -1 | awk '{ print $1 }') -c rancher -- reset-password\nNew password for default administrator (user-xxxxx):\n<new_password>\n"})}),"\n",(0,a.jsx)(r.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.a,{href:"https://blog.csdn.net/u010438035/article/details/131684587",children:"Ubuntu\u7cfb\u7edf\u79bb\u7ebf\u5b89\u88c5RKE2+Rancher2.7.5\u5168\u8fc7\u7a0b\u8bb0\u5f55"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.a,{href:"https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster",children:"Install/Upgrade Rancher on a Kubernetes Cluster"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.a,{href:"https://github.com/cert-manager/cert-manager/releases",children:"cert-manager Release"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.a,{href:"https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster/upgrades",children:"Upgrades"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.a,{href:"https://ranchermanager.docs.rancher.com/faq/technical-items",children:"Technical"})})]})}function o(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(i,{...e})}):i(e)}}}]);